(function(e){e.fn.charcounter=function(t,n){function s(s,u){s=e(s);if(s.val().length>t){s.val(s.val().substring(0,t));if(n.pulse&&!r){o(u,true)}}if(n.delay>0){if(i){window.clearTimeout(i)}i=window.setTimeout(function(){u.html(n.format.replace(/%1/,t-s.val().length))},n.delay)}else{u.html(n.format.replace(/%1/,t-s.val().length))}}function o(t,n){if(r){window.clearTimeout(r);r=null}t.animate({opacity:1},100,function(){e(this).animate({opacity:.06},100)});if(n){r=window.setTimeout(function(){o(t)},200)}}t=t||255;n=e.extend({container:"#shoutbox-message-counter",classname:"charcounter",format:"%1/255",pulse:true,delay:0},n);var r,i;return this.each(function(){var t=!n.container.match(/^<.+>$/)?e(n.container):e(n.container).insertAfter(this).addClass(n.classname);e(this).bind("keydown",function(){s(this,t)}).bind("keypress",function(){s(this,t)}).bind("keyup",function(){s(this,t)}).bind("focus",function(){s(this,t)}).bind("mouseover",function(){s(this,t)}).bind("mouseout",function(){s(this,t)}).bind("paste",function(){var e=this;setTimeout(function(){s(e,t)},10)});if(this.addEventListener){this.addEventListener("input",function(){s(this,t)},false)}s(this,t)})}})(jQuery);